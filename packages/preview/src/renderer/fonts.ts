/**
 * Bitmap Fonts for VirtualRenderer
 *
 * This module provides multiple typeface fonts for accurate ESC/P preview rendering.
 * Each font is an 8x16 bitmap font where each character is represented as 16 bytes
 * (one byte per row, 8 pixels per byte).
 */

import { TYPEFACE } from '@escp/core';
import { FONT_TIMES } from './font-times';
import { FONT_HELVETICA } from './font-helvetica';
import { FONT_COURIERNEW } from './font-courier';

/**
 * Glyph data: 16 bytes representing an 8x16 pixel character
 */
export type GlyphData = number[];

/**
 * A bitmap font containing glyphs for a specific typeface
 */
export interface BitmapFont {
  /** Typeface ID (matches TYPEFACE constant from @escp/core) */
  typeface: number;
  /** Human-readable font name */
  name: string;
  /** Glyph data indexed by character code */
  glyphs: Record<number, GlyphData>;
}

// =============================================================================
// ROMAN (Typeface 0) - Default serif font
// =============================================================================

const FONT_ROMAN: Record<number, GlyphData> = {
  // Space
  32: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // !
  33: [
    0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00,
  ],
  // "
  34: [
    0x00, 0x00, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // #
  35: [
    0x00, 0x00, 0x24, 0x24, 0x7e, 0x24, 0x24, 0x7e, 0x24, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // $
  36: [
    0x00, 0x00, 0x18, 0x3e, 0x60, 0x3c, 0x06, 0x7c, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // %
  37: [
    0x00, 0x00, 0x62, 0x64, 0x08, 0x10, 0x20, 0x4c, 0x8c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // &
  38: [
    0x00, 0x00, 0x30, 0x48, 0x48, 0x30, 0x4a, 0x44, 0x44, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // '
  39: [
    0x00, 0x00, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // (
  40: [
    0x00, 0x00, 0x0c, 0x18, 0x30, 0x30, 0x30, 0x30, 0x30, 0x18, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // )
  41: [
    0x00, 0x00, 0x30, 0x18, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x18, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // *
  42: [
    0x00, 0x00, 0x00, 0x00, 0x24, 0x18, 0x7e, 0x18, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // +
  43: [
    0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x7e, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // ,
  44: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x18, 0x30, 0x00, 0x00, 0x00,
  ],
  // -
  45: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // .
  46: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00,
  ],
  // /
  47: [
    0x00, 0x00, 0x02, 0x06, 0x0c, 0x18, 0x30, 0x60, 0xc0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // 0-9
  48: [
    0x00, 0x00, 0x3c, 0x66, 0x66, 0x6e, 0x76, 0x66, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  49: [
    0x00, 0x00, 0x18, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  50: [
    0x00, 0x00, 0x3c, 0x66, 0x06, 0x0c, 0x18, 0x30, 0x60, 0x66, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  51: [
    0x00, 0x00, 0x3c, 0x66, 0x06, 0x1c, 0x06, 0x06, 0x06, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  52: [
    0x00, 0x00, 0x0c, 0x1c, 0x3c, 0x6c, 0xcc, 0xfe, 0x0c, 0x0c, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  53: [
    0x00, 0x00, 0x7e, 0x60, 0x60, 0x7c, 0x06, 0x06, 0x06, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  54: [
    0x00, 0x00, 0x1c, 0x30, 0x60, 0x7c, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  55: [
    0x00, 0x00, 0x7e, 0x66, 0x06, 0x0c, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  56: [
    0x00, 0x00, 0x3c, 0x66, 0x66, 0x3c, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  57: [
    0x00, 0x00, 0x3c, 0x66, 0x66, 0x66, 0x3e, 0x06, 0x06, 0x0c, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // :
  58: [
    0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // ;
  59: [
    0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x30, 0x00, 0x00, 0x00, 0x00,
  ],
  // <
  60: [
    0x00, 0x00, 0x06, 0x0c, 0x18, 0x30, 0x60, 0x30, 0x18, 0x0c, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // =
  61: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // >
  62: [
    0x00, 0x00, 0x60, 0x30, 0x18, 0x0c, 0x06, 0x0c, 0x18, 0x30, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // ?
  63: [
    0x00, 0x00, 0x3c, 0x66, 0x06, 0x0c, 0x18, 0x18, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // @
  64: [
    0x00, 0x00, 0x3c, 0x66, 0x6e, 0x6a, 0x6e, 0x60, 0x60, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // A-Z (uppercase)
  65: [
    0x00, 0x00, 0x18, 0x3c, 0x66, 0x66, 0x7e, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  66: [
    0x00, 0x00, 0x7c, 0x66, 0x66, 0x7c, 0x66, 0x66, 0x66, 0x66, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  67: [
    0x00, 0x00, 0x3c, 0x66, 0x60, 0x60, 0x60, 0x60, 0x60, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  68: [
    0x00, 0x00, 0x78, 0x6c, 0x66, 0x66, 0x66, 0x66, 0x66, 0x6c, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  69: [
    0x00, 0x00, 0x7e, 0x60, 0x60, 0x7c, 0x60, 0x60, 0x60, 0x60, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  70: [
    0x00, 0x00, 0x7e, 0x60, 0x60, 0x7c, 0x60, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  71: [
    0x00, 0x00, 0x3c, 0x66, 0x60, 0x60, 0x6e, 0x66, 0x66, 0x66, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  72: [
    0x00, 0x00, 0x66, 0x66, 0x66, 0x7e, 0x66, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  73: [
    0x00, 0x00, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  74: [
    0x00, 0x00, 0x3e, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x6c, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  75: [
    0x00, 0x00, 0x66, 0x6c, 0x78, 0x70, 0x78, 0x6c, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  76: [
    0x00, 0x00, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  77: [
    0x00, 0x00, 0x63, 0x77, 0x7f, 0x6b, 0x63, 0x63, 0x63, 0x63, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  78: [
    0x00, 0x00, 0x66, 0x66, 0x76, 0x7e, 0x6e, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  79: [
    0x00, 0x00, 0x3c, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  80: [
    0x00, 0x00, 0x7c, 0x66, 0x66, 0x7c, 0x60, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  81: [
    0x00, 0x00, 0x3c, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x6c, 0x36, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  82: [
    0x00, 0x00, 0x7c, 0x66, 0x66, 0x7c, 0x6c, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  83: [
    0x00, 0x00, 0x3c, 0x66, 0x60, 0x30, 0x18, 0x0c, 0x06, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  84: [
    0x00, 0x00, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  85: [
    0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  86: [
    0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x3c, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  87: [
    0x00, 0x00, 0x63, 0x63, 0x63, 0x63, 0x6b, 0x7f, 0x77, 0x63, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  88: [
    0x00, 0x00, 0x66, 0x66, 0x3c, 0x18, 0x18, 0x3c, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  89: [
    0x00, 0x00, 0x66, 0x66, 0x66, 0x3c, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  90: [
    0x00, 0x00, 0x7e, 0x06, 0x0c, 0x18, 0x18, 0x30, 0x60, 0x60, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // [
  91: [
    0x00, 0x00, 0x3c, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // \
  92: [
    0x00, 0x00, 0x80, 0xc0, 0x60, 0x30, 0x18, 0x0c, 0x06, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // ]
  93: [
    0x00, 0x00, 0x3c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // ^
  94: [
    0x00, 0x00, 0x18, 0x3c, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // _
  95: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x00, 0x00, 0x00,
  ],
  // `
  96: [
    0x00, 0x00, 0x30, 0x18, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // a-z (lowercase)
  97: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x06, 0x3e, 0x66, 0x66, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  98: [
    0x00, 0x00, 0x60, 0x60, 0x60, 0x7c, 0x66, 0x66, 0x66, 0x66, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  99: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x66, 0x60, 0x60, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  100: [
    0x00, 0x00, 0x06, 0x06, 0x06, 0x3e, 0x66, 0x66, 0x66, 0x66, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  101: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x66, 0x7e, 0x60, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  102: [
    0x00, 0x00, 0x1c, 0x36, 0x30, 0x7c, 0x30, 0x30, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  103: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x66, 0x66, 0x66, 0x3e, 0x06, 0x66, 0x3c, 0x00, 0x00, 0x00,
  ],
  104: [
    0x00, 0x00, 0x60, 0x60, 0x60, 0x7c, 0x66, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  105: [
    0x00, 0x00, 0x18, 0x18, 0x00, 0x38, 0x18, 0x18, 0x18, 0x18, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  106: [
    0x00, 0x00, 0x0c, 0x0c, 0x00, 0x1c, 0x0c, 0x0c, 0x0c, 0x0c, 0x6c, 0x6c, 0x38, 0x00, 0x00, 0x00,
  ],
  107: [
    0x00, 0x00, 0x60, 0x60, 0x60, 0x66, 0x6c, 0x78, 0x6c, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  108: [
    0x00, 0x00, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  109: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x7f, 0x6b, 0x6b, 0x6b, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  110: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x66, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  111: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  112: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x66, 0x66, 0x66, 0x7c, 0x60, 0x60, 0x60, 0x00, 0x00, 0x00,
  ],
  113: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x66, 0x66, 0x66, 0x3e, 0x06, 0x06, 0x06, 0x00, 0x00, 0x00,
  ],
  114: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x6c, 0x76, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  115: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x60, 0x3c, 0x06, 0x06, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  116: [
    0x00, 0x00, 0x30, 0x30, 0x30, 0x7c, 0x30, 0x30, 0x30, 0x36, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  117: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x66, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  118: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  119: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x63, 0x6b, 0x6b, 0x7f, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  120: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x3c, 0x18, 0x3c, 0x66, 0x66, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  121: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0x66, 0x66, 0x3e, 0x06, 0x66, 0x3c, 0x00, 0x00, 0x00,
  ],
  122: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x0c, 0x18, 0x30, 0x60, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // {
  123: [
    0x00, 0x00, 0x0e, 0x18, 0x18, 0x18, 0x70, 0x18, 0x18, 0x18, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // |
  124: [
    0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // }
  125: [
    0x00, 0x00, 0x70, 0x18, 0x18, 0x18, 0x0e, 0x18, 0x18, 0x18, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],
  // ~
  126: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x32, 0x4c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ],

  // CP437 Box-drawing characters
  0xb3: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // │
  0xb4: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┤
  0xbf: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┐
  0xc0: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // └
  0xc1: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ┴
  0xc2: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┬
  0xc3: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ├
  0xc4: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ─
  0xc5: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┼
  0xd9: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ┘
  0xda: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┌
  // Double line
  0xba: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ║
  0xbb: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xf6, 0x00, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╗
  0xbc: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf6, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╝
  0xb9: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf6, 0x06, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╣
  0xc8: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╚
  0xc9: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x37, 0x00, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╔
  0xca: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf7, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╩
  0xcb: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0xf7, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╦
  0xcc: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x30, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╠
  0xcd: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ═
  0xce: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf7, 0x00, 0xf7, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╬
  // Mixed connectors
  0xb5: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xfe, 0x00, 0xfe, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ╡
  0xb6: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf8, 0x18, 0xf8, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╢
  0xb7: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0x06, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╖
  0xb8: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ╕
  0xbe: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x06, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╛
  0xbd: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╜
  0xc6: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x00, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ╞
  0xc7: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x30, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╟
  0xcf: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╧
  0xd0: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xff, 0x18, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╨
  0xd1: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ╤
  0xd2: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x18, 0xff, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╥
  0xd3: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x18, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╙
  0xd4: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x00, 0x3f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╘
  0xd5: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0x00, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ╒
  0xd6: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x18, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╓
  0xd7: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xff, 0x18, 0xff, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╫
  0xd8: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0x00, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ╪
  // Unicode box drawing
  0x2500: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ─
  0x2502: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // │
  0x250c: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┌
  0x2510: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┐
  0x2514: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // └
  0x2518: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ┘
  0x251c: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0x1f, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ├
  0x2524: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xf8, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┤
  0x252c: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┬
  0x2534: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ┴
  0x253c: [
    0x18, 0x18, 0x18, 0x18, 0x18, 0xff, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
  ], // ┼
  0x2550: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ═
  0x2551: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ║
  0x2554: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╔
  0x2557: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╗
  0x255a: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╚
  0x255d: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╝
  0x2560: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0x37, 0x30, 0x37, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╠
  0x2563: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf6, 0x06, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╣
  0x2566: [
    0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0x00, 0xf7, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╦
  0x2569: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf7, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  ], // ╩
  0x256c: [
    0x36, 0x36, 0x36, 0x36, 0x36, 0xf7, 0x00, 0xf7, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
  ], // ╬
};

// Fill missing ASCII characters with placeholder box
for (let i = 33; i < 127; i++) {
  if (!(i in FONT_ROMAN)) {
    FONT_ROMAN[i] = [
      0x00, 0x00, 0x7e, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x7e, 0x00, 0x00, 0x00, 0x00,
      0x00,
    ];
  }
}

// =============================================================================
// FONT REGISTRY
// =============================================================================

/**
 * All available fonts indexed by typeface ID
 * Initially only Roman is available; other typefaces will be added as converted
 */
const FONTS: Record<number, BitmapFont> = {
  [TYPEFACE.ROMAN]: { typeface: TYPEFACE.ROMAN, name: 'Roman (Times)', glyphs: FONT_TIMES },
  // Fonts converted from Adobe BDF files
  [TYPEFACE.SANS_SERIF]: {
    typeface: TYPEFACE.SANS_SERIF,
    name: 'Sans Serif (Helvetica)',
    glyphs: FONT_HELVETICA,
  },
  [TYPEFACE.COURIER]: { typeface: TYPEFACE.COURIER, name: 'Courier', glyphs: FONT_COURIERNEW },
  [TYPEFACE.PRESTIGE]: { typeface: TYPEFACE.PRESTIGE, name: 'Prestige', glyphs: FONT_TIMES },
  [TYPEFACE.SCRIPT]: { typeface: TYPEFACE.SCRIPT, name: 'Script', glyphs: FONT_TIMES },
  [TYPEFACE.OCR_B]: { typeface: TYPEFACE.OCR_B, name: 'OCR-B', glyphs: FONT_TIMES },
  [TYPEFACE.OCR_A]: { typeface: TYPEFACE.OCR_A, name: 'OCR-A', glyphs: FONT_TIMES },
  [TYPEFACE.ORATOR]: { typeface: TYPEFACE.ORATOR, name: 'Orator', glyphs: FONT_TIMES },
  [TYPEFACE.ORATOR_S]: { typeface: TYPEFACE.ORATOR_S, name: 'Orator-S', glyphs: FONT_TIMES },
  [TYPEFACE.SCRIPT_C]: { typeface: TYPEFACE.SCRIPT_C, name: 'Script-C', glyphs: FONT_TIMES },
  [TYPEFACE.ROMAN_T]: { typeface: TYPEFACE.ROMAN_T, name: 'Roman-T', glyphs: FONT_TIMES },
  [TYPEFACE.SANS_SERIF_H]: {
    typeface: TYPEFACE.SANS_SERIF_H,
    name: 'Sans Serif H',
    glyphs: FONT_HELVETICA,
  },
  [TYPEFACE.SV_BUSABA]: { typeface: TYPEFACE.SV_BUSABA, name: 'SV Busaba', glyphs: FONT_TIMES },
  [TYPEFACE.SV_JITTRA]: { typeface: TYPEFACE.SV_JITTRA, name: 'SV Jittra', glyphs: FONT_TIMES },
};

/**
 * Get the bitmap font for a given typeface ID
 * Falls back to Roman if the typeface is not found
 */
export function getFont(typeface: number): BitmapFont {
  return FONTS[typeface] ?? FONTS[TYPEFACE.ROMAN]!;
}

/**
 * Get the glyph data for a character in a specific typeface
 * Falls back to space character if the glyph is not found
 */
export function getGlyph(typeface: number, charCode: number): GlyphData {
  const font = getFont(typeface);
  return (
    font.glyphs[charCode] ?? font.glyphs[32] ?? [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  );
}

/**
 * Register a new font for a typeface
 * This can be used to add fonts converted from BDF files
 */
export function registerFont(
  typeface: number,
  name: string,
  glyphs: Record<number, GlyphData>
): void {
  FONTS[typeface] = { typeface, name, glyphs };
}

/**
 * Check if a typeface has a dedicated font (not just fallback to Times)
 * Returns true only for typefaces with unique glyph sets:
 * - ROMAN uses FONT_TIMES (its own dedicated font)
 * - SANS_SERIF uses FONT_HELVETICA (its own dedicated font)
 * - COURIER uses FONT_COURIERNEW (its own dedicated font)
 * Other typefaces fall back to FONT_TIMES and return false
 */
export function hasFont(typeface: number): boolean {
  // Only these three typefaces have their own dedicated fonts
  return (
    typeface === TYPEFACE.ROMAN || typeface === TYPEFACE.SANS_SERIF || typeface === TYPEFACE.COURIER
  );
}

// Export font data for direct use
export { FONT_ROMAN, FONT_TIMES, FONT_HELVETICA, FONT_COURIERNEW };
